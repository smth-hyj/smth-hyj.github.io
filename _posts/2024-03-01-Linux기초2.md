---
title: Linux 기초 (下)
date: 2024-03-01 20:00:00 +09:00
categories: [국비, linux]
tags: [linux, 환경설정, 리눅스, centos]		# TAG는 반드시 소문자로 이루어져야함!
---
# 리눅스 기초 
> *해당 내용은 수업에 사정이 있어서 난잡할 수 있다.*

### 사용자 정의 변수 및 환경 변수
- env(환경변수) 종류
    - PATH, TERM, EDITOR, ...
- 변수는 대소문자를 구별한다.(주의)

```bash
export 변수=값 				 # 변수 선언 방법
export path=$path:$HOME/bin  #해당 변수 환경변수로 설정
echo $변수     				 # 변수 확인
unset 변수     				 # 변수 해지

# Env
env            			  	# 모든 환경변수 보기
env cmd           	  	  	# 명령실행
env path=$path:$HOME/bin 	# 환경변수 지정. 변수안에 여러 값이 있으면 ":"으로 구분
env -u path    				# 설정값 해제
env -i ls      				# 종속된 환경을 무시하고 명령실행
```

### 경로
- OS에서는 경로에 따라 파일의 위치, 실행 위치 등이 달라지기 때문에 경로가 중요하다. 
- 리눅스에서 경로를 지정할 때는 두가지 방법이 있다.
	- 절대경로(Absolute path): 최상위 디렉토리(/)부터 쓰는 것
	- 상대경로(Relative path): 시작이 현재 위치한 디렉토리 혹은 최상위 디렉토리부터 시작하지 않는 것.
	- 상대경로 표현법

	```bash
	. 		  	# 현재 위치
	.. 		  	# 바로 위 위치
	cd ../bin 	# 현재 디렉토리 바로 위의 아래에 있는 bin 디렉토리에 가기
	```


- 리눅스 최상위 구조

![image](https://github.com/smth-hyj/smth-hyj.github.io/assets/147927247/62a02634-6bd4-4e2c-8d7b-35023d4a890b) 

- PATH 변수 : 명령어를 검색할 디렉토리를 지정

![image](https://github.com/smth-hyj/smth-hyj.github.io/assets/147927247/2367657f-264f-4807-883c-03b96aa6554a)

- 경로 관련 명령어 정리

```bash
pwd 		# 현재 경로를 절대 경로로 보는 명령어
cd 			# 디렉토리로 이동하기(그냥 cd만 쓰면 현재 계정 홈디렉토리로 이동)
ls			# 현재 디렉토리 안에 있는 디렉토리 및 파일 보여주기
# ls 옵션
ls -l 		# 디렉토리 및 파일 더 자세하게 보기
ls -a 		# 숨겨진 디렉토리 및 파일까지 다 보기
ls --help	# ls 명령어 옵션보기
ls -d 		# 현재 디렉토리만 보기
ls -c		# 정렬
ls -s 		# 크기가 큰 순서대로 정렬
## 옵션들을 합쳐서 쓸수도 있다.(ex. ls -al)
```

### 검색 관련 명령어

#### [추가] 리다이렉션과 파이프기호 

> redirection : <, >, >>, 2>, 2>>  
> pipe symbol : |  ==  #명령어의 결과값을 파이프 기호 다음 명령어로 넘기기  
> ex. CMD < 파일 : 파일안의 내용을 CMD처리  
> ex. CMD > 파일 : CMD 결과값을 파일안에 새로쓰기  
> ex. CMD >> 파일 : 결과값을 파일안에 추가쓰기  
> ex. CMD 2> 파일 : 표준오류값 새로 파일에 넣기  
> ex  CMD 2>> 파일 : 오류값 파일에 추가쓰기  
> ex. CMD | more  
> ex. CMD | grep root  
> ex. CMD | CMD | CMD ...  

> 메타문자 : 정규표현식이나 정규식을 제어하는 문자들
>> '', "", \, ``, ;

```bash
grep option pattern CMD 
option : -i, --color, -n, -A, -l
pattern : *, ., ^root, root$, [abc] [a-c], [^a]
# find CMD
find / -name 이름 -type 타입
find / -user fedora -group fedora
find / -mtime -7|7|+7
find / -size --200M|200M|+200M
find / -permission
find / -name 이름 -type 타입 -exec CMD {} \;

# wc CMD
wc /etc/passwd 하면 
라인, 워드, 캐릭터 개수를 구할 수 있음
wc -l # (라인 카운트)
wc -w # (워드 카운트)
wc -c # (캐릭터 카운트)
rpm -qa | wc -l
# 현재 다운받은 패키지가 몇개인지 볼 때
``` 

### 네트워크 설정
네트워크 확인 :
```bash
ip addr						#ip
ip route					#gw
cat /etc/resolv.conf		#DNS 
# 설정
nmtui
nm-connection-editor
nmcli CMD
```

Bridge connection : OS 와 동일한 IP 대역을 씀
Route connection(NAT) : 인터넷 연결 가능
SCSI는 recommended로 설정
disc type = SCSI 타입
allocate 설정 건드리지 말기

gnome-tweaks gnome : GUI 꾸미기(아이콘, 폰트 등등)


### 퍼미션과 권한

```bash
su			# 계정변환		# (= 일반 사용자끼리 사용가능하도록 하는게 나음)
sudo CMD 	# 해당 계정 권한으로 명령어 수행
			# root 암호를 공유할 필요 없이 루트 권한 시행가능
			# 사용자가 관리자 권한으로 수행하는 사용할 수 있는 명령어의 제한을 둘 수 있다
su -c '명령어' # 사용자 명령어 == sudo CMD: 루트권한으로 명령어 시행
sudo -l 	#[sudo 리스트]
sudo -i 	#(sudo -root과 비슷)
``` 

일반 사용자는 명령어 외에는 폴더를 만들수 없다.   
ex. sudo echo WEB > /var/www/html/index.html  
에서 문제가 생김  
==> echo WEB page | sudo tee -a /var/www/html/index.html  
==> sudo vi /var/www/html/index.html  

```bash
sudo 'CMD'
sudo -l
sudo -i
에러 시
usermod -aG wheel fedora (관리자 권한 추가로 바꾸기)
useradd -G wheel fedora (관리자 한 추가하면서 생성)

cmd | tee file.log == cmd > file.log
# tee라는 명령어는 앞의 명령어를 뒤에 쓴
모니터에 출력 및 파일에도 저장되게 하려면 tee 명령어를 쓰면 된다.
tee file.log = >
tee -a

ls -l file1
#-:rw-:r--:r--: 1 :root root: 0 : 1월 30 02:52 : file1
#파일타입 : 유저의 권한 : 같은 그룹의 권한 : 아예다른 사용자 : 하드링크 카운트 : 소유자 : 그룹 : 크기 : 시간(mtime=modified time) : 이름
ln # 명령어로 링크 카운트를 늘려줄 수 있음

chown -R # 경로와 그 하위 파일들을 모두 바꿔준다
chown user.group == chwon user:group

chgrp CMD #그룹을 바꿔준다.

chmod CMD
#심볼릭 모드(symbolic), 옥탈모드(octal)
#심볼릭 모드는 문자(ugo,rwx)로 옥탈모드는 숫자(0~7)로

find . -ls # 현재 위치 모든 설정을 보여줌
```

### 파일과 디렉토리의 권한
디렉토리는 실행 권한은 꼭 가지고 있어야한다.
디렉토리 w권한을 실행하려면 x권한을 가지고 있어야한다.

id로 uid, gid, 그룹을 확인해야한다.
지우기를 못하면 생성도 불가  

실무에서 권한 응용 예  
1) 실행 권한 (ex: /bin/ls, $HOME/bin/scripts.sh)
읽지는 못하지만 실행은 가능하게 읽고 수정은 가능하지만 실행은 못하게d
2) 읽기 권한 웹사용자가 웹페이지 읽기
systemctl enable --now httpd
<alt +F4>
3) 보안 퍼미션 조정

umask는 서버에서 바꾸면 안됨
기본 체계를 쓰면 된다.
umask는 관리자가 변경하면 안됨
그냥 기본 퍼미션을 조정하는 값이다.

명령어로 바꾼 거는 현재 창에만 적용되어 영구적으로 하고 싶으면 환경파일로 들어가야함

.bashrc환경파일에 umask 내용이 있는데 보통 관리자: 022, 일반사용자:002로 씀

### 화녁파일와 쉘(SHELL)
bash 기능 확장한 zsh 쉘 기능
- shell prompt color
- syntax highlighting
- autosuggestion(history)

환경파일 알기
- /etc/profile에는 시스템적으로 건드는 설정(로그인할 때)  
- $HOME/.bash_profile 설정하고 한번만 적용 
- $HOME/.bashrc는 배쉬가 실행될때만 실행  
- $HOME/.bash_logout 로그아웃할 때 읽어짐  


환경화일 분석
if ~~ then
~~ : 조건


- 변수 설정
- 앨리어스
- 쉘 자체의 기능
- 기타(아무거나)등등이 환경파일에 들어갈 수 있다.

- 권한에 따른 환경파일 수정
	- 관리자 : /etc/profile
	- 사용자 : $HOME/.bashrc

중요도에 따라 순서가 달라진다.  
전역 설정 : 변수의 재정의  
맨 마지막에 읽어드리는 파일에 따라 변수의 값이 달라질 수 있기 때문에 맨 마지막에 읽어드리는 파일에 넣는게 좋음 환경설정은 한곳에 몰아넣는것이 좋음
사용자가 어차피 설정을 하기 대문에 관리자는 필요한 설정만 하는 것이 좋음

밑에 다가 정의하기~

- Alias란  
명령어를 짧게 줄이거나 애칭을 정할 때 많이 씀
접속을 달리하면 헷갈릴 수 있음 따라서 명령어를 바꿔서 해주면 좋다~
오타나는 명령어 또한 alias로 바꿔주면 좋다

서버에서 alias 중 반드시 들어가야하는 것
웹서버의 경우
주설정 파일, 소스 디렉토리, 로그디렉토리를 자주 쓴다
--> 이러한 파일들을 명령어 처리 해주면 더욱 쉽고 간편하게 일을 할 수 있다.

로그파일을 건들 때도 씀
로그파일 같은 경우는 날짜가 매번 바뀌고 변경이 되면 안되기 때문에 이름을 고정해서 alias를 걸어두거나 하면 안되기 때문에 view로 tail -f /log/file_`date +%m%d`.log로 할 수 있음
혹은 `date -d '1 days age' +%m%d`로 할 수 도 있음